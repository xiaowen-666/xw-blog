<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Titanic - Machine Learning from Disaster | 小w-blog</title><meta name="author" content="小w"><meta name="copyright" content="小w"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="泰坦尼克号灾难预测 使用 Deep Learning 创建一个预测模型，来预测哪些乘客在泰坦尼克号沉船中可以幸存下来。        背景 The sinking of the Titanic is one of the most infamous shipwrecks in history.On April 15, 1912, during her maiden voyage, the wide">
<meta property="og:type" content="article">
<meta property="og:title" content="Titanic - Machine Learning from Disaster">
<meta property="og:url" content="http://example.com/2023/05/22/Titanic/index.html">
<meta property="og:site_name" content="小w-blog">
<meta property="og:description" content="泰坦尼克号灾难预测 使用 Deep Learning 创建一个预测模型，来预测哪些乘客在泰坦尼克号沉船中可以幸存下来。        背景 The sinking of the Titanic is one of the most infamous shipwrecks in history.On April 15, 1912, during her maiden voyage, the wide">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/image/Titanic/mountains.jpg">
<meta property="article:published_time" content="2023-05-21T16:00:00.000Z">
<meta property="article:modified_time" content="2023-05-21T16:00:00.000Z">
<meta property="article:author" content="小w">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/Titanic/mountains.jpg"><link rel="shortcut icon" href="/img/BLOG.png"><link rel="canonical" href="http://example.com/2023/05/22/Titanic/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Titanic - Machine Learning from Disaster',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-22 00:00:00'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/wallhaven-k7q1l1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/image/Titanic/mountains.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="小w-blog"><span class="site-name">小w-blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Titanic - Machine Learning from Disaster</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-05-21T16:00:00.000Z" title="Created 2023-05-22 00:00:00">2023-05-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-05-21T16:00:00.000Z" title="Updated 2023-05-22 00:00:00">2023-05-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Titanic - Machine Learning from Disaster"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="泰坦尼克号灾难预测"><a href="#泰坦尼克号灾难预测" class="headerlink" title="泰坦尼克号灾难预测"></a>泰坦尼克号灾难预测</h1><ul>
<li>使用 <em><strong>Deep Learning</strong></em> 创建一个预测模型，来预测哪些乘客在泰坦尼克号沉船中可以幸存下来。</li>
</ul>
<br>

<p><img src="/image/Titanic/background.jfif" alt="Titanic"></p>
<br>
<br>

<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><ul>
<li>The sinking of the <strong>Titanic</strong> is one of the most infamous shipwrecks in history.<br>On April 15, 1912, during her maiden voyage, the widely considered “unsinkable” RMS Titanic sank after colliding with an iceberg.   Unfortunately, there weren’t enough lifeboats for everyone onboard, resulting in the death of 1502 out of 2224 passengers and crew.While there was some element of luck involved in surviving, it seems some groups of people were more likely to survive than others.</li>
</ul>
<hr>
<h2 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h2><ul>
<li>了解了相关信息及背景后，决定采用<code>PyTorch</code>深度学习框架，通过使用乘客数据（即姓名，年龄，性别，社会经济阶层等）构建<strong>Titanic</strong>的二分类预测模型。</li>
</ul>
<h5 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_preprocessed</span>():</span><br><span class="line">    datas = pd.read_csv(<span class="string">&#x27;data/train.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    data = pd.get_dummies(datas[[<span class="string">&#x27;Pclass&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;SibSp&#x27;</span>, <span class="string">&#x27;Parch&#x27;</span>, <span class="string">&#x27;Survived&#x27;</span>]])</span><br><span class="line">    survive = data.pop(data.columns[<span class="number">3</span>])</span><br><span class="line">    data[<span class="string">&#x27;Survived&#x27;</span>] = survive</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;train.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">        np.savetxt(f, data, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">testdata_preprocessed</span>():</span><br><span class="line">    datas = pd.read_csv(<span class="string">&#x27;data/test.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    data = pd.get_dummies(datas[[<span class="string">&#x27;Pclass&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;SibSp&#x27;</span>, <span class="string">&#x27;Parch&#x27;</span>]])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;test.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">        np.savetxt(f, data, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    testdata_preprocessed()</span><br><span class="line">    data_preprocessed()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">采用pandas和numpy对数据集进行预处理，将其分别保存在对应的csv文件中。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<ul>
<li>对数据进行预处理后，开始编写主程序构建预测模型。</li>
</ul>
<h5 id="导入相应模块"><a href="#导入相应模块" class="headerlink" title="导入相应模块"></a>导入相应模块</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>

<h5 id="编写神经网络模型"><a href="#编写神经网络模型" class="headerlink" title="编写神经网络模型"></a>编写神经网络模型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(torch.nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n_feature, n_hidden, n_hidden2, n_hidden3, n_output</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.feature = torch.nn.Linear(n_feature, n_hidden)</span><br><span class="line">        self.layer = torch.nn.Linear(n_hidden, n_hidden2)</span><br><span class="line">        self.layer2 = torch.nn.Linear(n_hidden2, n_hidden3)</span><br><span class="line">        self.predict = torch.nn.Linear(n_hidden3, n_output)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = torch.sigmoid(self.feature(x))</span><br><span class="line">        x = torch.sigmoid(self.layer(x))</span><br><span class="line">        x = torch.sigmoid(self.layer2(x))</span><br><span class="line">        x = torch.sigmoid(self.predict(x))</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">构建一层输入层，两层隐含层，一层输出层。全部采用sigmoid激活函数连接层。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="加载数据集"><a href="#加载数据集" class="headerlink" title="加载数据集"></a>加载数据集</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">data_handling</span>():</span><br><span class="line">    data_preprocessed()</span><br><span class="line">    data = np.loadtxt(<span class="string">&#x27;train.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, dtype=np.float32)</span><br><span class="line">    x = torch.from_numpy(data[:, :-<span class="number">1</span>])</span><br><span class="line">    y = torch.from_numpy(data[:, [-<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">    test_x = np.loadtxt(<span class="string">&#x27;test.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, dtype=np.float32)</span><br><span class="line">    test_x = torch.from_numpy(test_x)</span><br><span class="line"></span><br><span class="line">    test_y = pd.read_csv(<span class="string">&#x27;data/gender_submission.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    test_y = test_y.values</span><br><span class="line">    <span class="keyword">return</span> x, y, test_x, test_y</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">加载预处理的数据集，和验证集。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="迭代计算"><a href="#迭代计算" class="headerlink" title="迭代计算"></a>迭代计算</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    all_data = data_handling()</span><br><span class="line">    x = all_data[<span class="number">0</span>]</span><br><span class="line">    y = all_data[<span class="number">1</span>]</span><br><span class="line">    test_x = all_data[<span class="number">2</span>]</span><br><span class="line">    test_y = all_data[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    net = Net(<span class="number">5</span>, <span class="number">330</span>, <span class="number">300</span>, <span class="number">215</span>, <span class="number">1</span>)</span><br><span class="line">    optimizer = torch.optim.Adam(net.parameters(), lr=<span class="number">0.00015</span>)</span><br><span class="line">    loss_func = torch.nn.BCELoss()</span><br><span class="line">    plt.ion()</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    epochs = <span class="number">1000</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        y_train_hat = net(x)</span><br><span class="line">        loss_train = loss_func(y_train_hat, y)</span><br><span class="line"></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss_train.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        y_test_hat = net(test_x)</span><br><span class="line">        <span class="keyword">if</span> epoch % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">            plt.cla()</span><br><span class="line">            spot_1, = plt.plot(test_y, <span class="string">&#x27;r*&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">            spot_2, = plt.plot(y_test_hat.data.numpy(), <span class="string">&#x27;bo&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">            plt.xlabel(<span class="string">&#x27;epoch&#x27;</span>)</span><br><span class="line">            plt.ylabel(<span class="string">&#x27;result&#x27;</span>)</span><br><span class="line">            plt.legend((spot_1, spot_2), [<span class="string">&#x27;real&#x27;</span>, <span class="string">&#x27;test&#x27;</span>])</span><br><span class="line">            plt.pause(<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">if</span> epoch == epochs-<span class="number">1</span>:</span><br><span class="line">            threshold = <span class="number">0.5</span></span><br><span class="line">            preduction = (y_test_hat &gt;= threshold).<span class="built_in">int</span>()</span><br><span class="line">            preduction = preduction.data.numpy()</span><br><span class="line">            result = np.equal(test_y, preduction)</span><br><span class="line">            correct_ratio = np.mean(result)</span><br><span class="line">            <span class="built_in">print</span>(correct_ratio)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">                np.savetxt(f, preduction, delimiter=<span class="string">&#x27;,&#x27;</span>, fmt=<span class="string">&#x27;%d&#x27;</span>)</span><br><span class="line">    plt.ioff()</span><br><span class="line">    plt.show()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">定义输入层单元数即为决策变量数，隐含层各层单元数，输出层单元数为一。采用Adam优化器，设置学习率为0.00015，选择BCELoss二分类损失函数。</span></span><br><span class="line"><span class="string">对数据集进行1000次迭代学习。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">运行主程序</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="预测模型准确率及result数据集"><a href="#预测模型准确率及result数据集" class="headerlink" title="预测模型准确率及result数据集"></a>预测模型准确率及result数据集</h2><ul>
<li>通过深度学习预测模型得到幸存者数据集 <em><strong>result.csv</strong></em> 并与 <em><strong>gender_submission.csv</strong></em> 数据集进行预测模型准确性的验证。</li>
</ul>
<p><img src="/image/Titanic/result.png" alt="result"><br><img src="/image/Titanic/correct.png" alt="correct"></p>
<blockquote>
<p>预测的准确性到了 <strong>97.85%</strong> ，表明模型训练得还不错。{后来提交后也继续训练过多次，最高到达过 <strong>98.80%</strong> 的准确率！}</p>
</blockquote>
<hr>
<h2 id="提交数据"><a href="#提交数据" class="headerlink" title="提交数据"></a>提交数据</h2><ul>
<li>提交 <em><strong>result.csv</strong></em> 结果。</li>
</ul>
<br>

<p><img src="/image/Titanic/grade.png" alt="grade"></p>
<blockquote>
<p>得到了 <strong>77.751</strong> 分数，排名 <strong>4502</strong> 名次。很不错的成绩！😁</p>
</blockquote>
</article><div class="tag_share"><div class="post_share"></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/wallhaven-k7q1l1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">小w</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%B0%E5%9D%A6%E5%B0%BC%E5%85%8B%E5%8F%B7%E7%81%BE%E9%9A%BE%E9%A2%84%E6%B5%8B"><span class="toc-number">1.</span> <span class="toc-text">泰坦尼克号灾难预测</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%91%E6%88%98"><span class="toc-number">1.2.</span> <span class="toc-text">挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">数据预处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E7%9B%B8%E5%BA%94%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.0.0.2.</span> <span class="toc-text">导入相应模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.0.0.3.</span> <span class="toc-text">编写神经网络模型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">1.2.0.0.4.</span> <span class="toc-text">加载数据集</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E8%AE%A1%E7%AE%97"><span class="toc-number">1.2.0.0.5.</span> <span class="toc-text">迭代计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.2.0.0.6.</span> <span class="toc-text">运行程序</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E6%B5%8B%E6%A8%A1%E5%9E%8B%E5%87%86%E7%A1%AE%E7%8E%87%E5%8F%8Aresult%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">1.3.</span> <span class="toc-text">预测模型准确率及result数据集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.</span> <span class="toc-text">提交数据</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/15/frp%20Internal%20network%20penetration/" title="Frp内网穿透实现ssh远程连接和博客部署"><img src="/image/frp/wallhaven-l8x1pr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Frp内网穿透实现ssh远程连接和博客部署"/></a><div class="content"><a class="title" href="/2025/05/15/frp%20Internal%20network%20penetration/" title="Frp内网穿透实现ssh远程连接和博客部署">Frp内网穿透实现ssh远程连接和博客部署</a><time datetime="2025-05-14T16:00:00.000Z" title="Created 2025-05-15 00:00:00">2025-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/29/bp-model/" title="神经网络基础知识点及手搓BP神经网络"><img src="/image/BP-model/wallhaven-mp5o1k.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="神经网络基础知识点及手搓BP神经网络"/></a><div class="content"><a class="title" href="/2025/04/29/bp-model/" title="神经网络基础知识点及手搓BP神经网络">神经网络基础知识点及手搓BP神经网络</a><time datetime="2025-04-28T16:00:00.000Z" title="Created 2025-04-29 00:00:00">2025-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/01/M-P%20model/" title="M-P模型"><img src="/image/M-P_Model/wallhaven-dgp9eg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="M-P模型"/></a><div class="content"><a class="title" href="/2025/01/01/M-P%20model/" title="M-P模型">M-P模型</a><time datetime="2024-12-31T16:00:00.000Z" title="Created 2025-01-01 00:00:00">2025-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/30/category%20copy/" title="数据预处理"><img src="/image/Data%20preprocessing/wallhaven-yxdrex.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据预处理"/></a><div class="content"><a class="title" href="/2024/12/30/category%20copy/" title="数据预处理">数据预处理</a><time datetime="2024-12-29T16:00:00.000Z" title="Created 2024-12-30 00:00:00">2024-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/30/regularization/" title="正则化"><img src="/image/Regularization/luizclas.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="正则化"/></a><div class="content"><a class="title" href="/2024/12/30/regularization/" title="正则化">正则化</a><time datetime="2024-12-29T16:00:00.000Z" title="Created 2024-12-30 00:00:00">2024-12-30</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>